---
import Badge from './Badge.astro';

export interface Props {
  title: string;
  description: string;
  date: string;
  link?: string;
  tags?: string[];
  image?: string;
}

const { title, description, date, link, tags, image } = Astro.props;

// Formatear fecha de forma más legible
const formatDate = (dateString: string) => {
  const dateObj = new Date(dateString);
  return dateObj.toLocaleDateString('es-ES', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
};
---

<article class="
  group
  bg-bg-secondary
  border border-border
  rounded-xl
  overflow-hidden
  transition-all duration-300 ease-in-out
  hover:border-border-emphasis
  hover:shadow-xl hover:shadow-primary-500/5
  hover:scale-[1.02]
  reveal
  cursor-pointer
" data-tags={tags?.join(',')}>

  <!-- Imagen con efecto zoom -->
  {image && (
    <div class="relative overflow-hidden">
      <img
        src={image}
        alt={title}
        class="
          w-full h-48 object-cover
          transition-transform duration-300
          group-hover:scale-110
        "
        loading="lazy"
      />
      <!-- Overlay gradient sutil -->
      <div class="
        absolute inset-0
        bg-gradient-to-t from-bg-primary/60 to-transparent
        opacity-0 group-hover:opacity-100
        transition-opacity duration-300
      "></div>
    </div>
  )}

  <!-- Contenido -->
  <div class="p-6 space-y-4">

    <!-- Metadata -->
    <div class="flex items-center gap-3 text-sm text-text-tertiary">
      <time datetime={date}>
        {formatDate(date)}
      </time>
      {tags && tags.length > 0 && (
        <>
          <span aria-hidden="true">•</span>
          <span>{tags.length} {tags.length === 1 ? 'tag' : 'tags'}</span>
        </>
      )}
    </div>

    <!-- Título -->
    <h2 class="
      text-2xl font-bold text-text-primary
      leading-tight
      transition-colors duration-200
      group-hover:text-primary
    ">
      {link ? (
        <a href={link} class="hover:underline">
          {title}
        </a>
      ) : (
        title
      )}
    </h2>

    <!-- Descripción -->
    <p class="text-text-secondary leading-relaxed line-clamp-3">
      {description}
    </p>

    <!-- Tags -->
    {tags && tags.length > 0 && (
      <div class="flex flex-wrap gap-2 pt-2">
        {tags.map(tag => (
          <Badge variant="category">
            {tag}
          </Badge>
        ))}
      </div>
    )}

    <!-- Link "Leer más" (opcional) -->
    {link && (
      <div class="pt-2">
        <a
          href={link}
          class="
            inline-flex items-center gap-2
            text-primary-500 hover:text-primary-400
            font-medium text-sm
            transition-colors duration-200
            group/link
          "
        >
          <span>Leer más</span>
          <svg
            class="w-4 h-4 transition-transform duration-200 group-hover/link:translate-x-1"
            fill="currentColor"
            viewBox="0 0 20 20"
          >
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </a>
      </div>
    )}
  </div>

</article>

<style>
  /* Line clamp para descripción */
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
